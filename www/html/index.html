<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<link href="/wheel/bootstrap.min.css" rel="stylesheet"></link>
	<link href="/wheel/Chart.css" rel="stylesheet"></link>
	<script src="/wheel/vue.global.prod.js"></script>
	<script src="/wheel/Chart.bundle.min.js"></script>
	<script src="/scripts/canvasart.js"></script>
	<!--<script src="/wheel/vue-chartjs.min.js"></script>-->
	<title>TAN labs speed tester</title>
<style>

.slide-fade-enter-active {
	transition: all .3s ease-out;
}

.slide-fade-leave-active {
	transition: all .1s cubic-bezier(1.0, 0.5, 0.8, 1.0);
}

.slide-fade-enter-from,
.slide-fade-leave-to {
	transform: translateX(-50px);
	opacity: 0;
}

</style>
</head>

<body> 
	<div style='padding: 0; margin: 0;' id='speedtesterapp'>
		<header class="navbar navbar-expand navbar-dark" style='background-color: purple'>
			<a class="navbar-brand" v-on:click='demoStep'>TAN Labs Speed Tester</a>
			<div class="collapse navbar-collapse" id="navbarText">
				<span class='navbar-text'>{{ current_status }}</span>
			</div>
		</header>

		<div class='container-fluid'>
			<div class='row'>
				<transition name="slide-fade">
					<div v-if='show_ctrl' class='col-4 h-100' style='border-right: solid 1px'>
						<div class='row' style='height: 32px'>
							<div class='col-12'>
								<div class='float-right'>
									<button class='btn btn-sm btn-link' v-on:click='collapseCtrl'>Collapse &lt;</button>
								</div>
							</div>
						</div>
						<h2>Load a test result</h2>
						<small>Not supported yet</small>
						<h2>Start a test</h2>
						<button class='btn btn-outline-info'>Load test config</button>
						<br/>
						<button class='btn btn-outline-info'>Dump test config</button>
						<br/>
						<button class='btn btn-success' v-on:click='startAllTests'>Start complete test</button>
						<br/><hr/>

						<div class='form-group'>
							<h3 for='ripcnt'>Size of RIP record table</h3>
							<input class='form-control' v-model='n_rip'/>
							<button class='btn btn-outline-success'>Start RIP test</button>
							<br/><hr/>
						</div>

						<div class='float-right'>
							<button v-on:click='addCase' href='#' class='btn btn-sm btn-outline-primary'>Add</button>
						</div>
						<h3>Connectivity test cases</h3>
						<p> <small>Specify a target port for each port. 0 stands for not sending any packet.</small> </p>
						<div class='form-group' v-for='(c, i) in conn_cases'>
							<div class='float-right'>
								<button v-on:click='removeCase(i)' class='btn btn-sm btn-outline-danger'>Remove</button>
							</div>
							<h4>Case {{i}}</h4>
							<div v-for='(src, j) in c' class='row'>
								<label class='col-8'>Target of input router {{j + 1}}</label>
								<div class='col-4'>
									<input class='form-control' type='number' v-model='src'/>
								</div>
								<hr/>
							</div>
							<button class='btn btn-outline-success'>Start IP test {{i}}</button>
							<hr/>
						</div>
						<div class='row'  v-if='conn_cases.length > 0'>
							<div class='col-12'>
								<button class='btn btn-outline-success'>Start all IP tests</button>
								<br/><hr/>
							</div>
						</div>

						<div class='form-group'>
							<h3>Throughput test</h3>
							<label>Pakcet sizes</label>
							<input class='form-control' v-model='n_packet'/>
							<button class='btn btn-outline-success'>Start throughput test</button>
						</div>

					</div>
				</transition>

				<div v-bind:class='{ "col-8": show_ctrl, "col-12": !show_ctrl }'>
					<div class='row' style='height: 32px'>
						<div class='col-12'>
							<div class='float-left'>
								<button v-if='!show_ctrl' v-on:click='expandCtrl' class='btn btn-sm btn-link'>&gt; Expand control bar</button>
							</div>
						</div>
					</div>
					<h2>{{report_title}}</h2>

					<div class='row' v-for='(r, i) in logs' :ref="'logs' + i">
						<div class='col-12' v-if='r.type == "rip"'>
							<h3>RIP test with {{r.n_rip}} records</h3>
							<div class='alert' v-bind:class='{"alert-success": r.passed, "alert-danger": !r.passed}'>
								<p v-if='r.passed'>Passed, connection created in {{r.latency}} ms</p>
								<p v-if='!r.passed'>Failed with message: </p>
								<pre v-if='!r.passed'>{{r.error}}</pre>
							</div>
						</div>

						<div class='col-12' v-if='r.type == "ip"'>
							<h3>IP connectivity test</h3>
							<canvas width='1024' height='768'>{{drawTopo(i)}}</canvas>
						</div>

						<br/><hr/>
					</div>

				</div>
			</div>
		</div>

		<script src='/scripts/demo.js'></script>
	</div>
</body>
</html>
